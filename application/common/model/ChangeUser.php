<?phpnamespace app\common\model;use think\Db;use think\Exception;use think\Session;//更换人员class ChangeUser extends BaseModel{    //添加记录(用于后台)    function add($data)    {        $this->allowField(true)->save($data);    }    //获取更换人员记录    function getChangeList($task_id)    {        $list= $this->alias('c')            ->join('make_beam mb','mb.task_id=c.task_id','left')            ->join('department d','d.id=c.department_id','left')            ->field([                'c.task_id',                'mb.title',                'c.department_id',                'd.title as depart',                'c.old_user',                'c.new_user',                'c.remark_process',                'c.remark_reason',                'c.create_time',            ])            ->where('c.task_id',$task_id)            ->paginate(20, false, ['query' => request()->get()]);        foreach ($list as &$item)        {            $item['old_username'] = Db::name('user')->where('id',$item['old_user'])->value('name');            $item['new_username'] = Db::name('user')->where('id',$item['new_user'])->value('name');        }        return $list;    }}